/**
*  v0.0.1
* Copyright 2013 
*/
function FrontPage($scope,$http,$sce){$scope.posts=[],$scope.getPage=function(){var url;url=Reddit.subreddit?"http://www.reddit.com/r/"+$scope.subreddit+"/.json?limit="+Settings.numPosts+"&sort="+Settings.sortBy+"&after="+Reddit.after[Reddit.after.length-1]:"http://www.reddit.com/.json?&limit="+Settings.numPosts+"&sort="+Settings.sortBy+"&after="+Reddit.after[Reddit.after.length-1],$http.get(url).success(function(data){$scope.parseData(data)}).error(function(data){console.log(data)})},$scope.getPage(),$scope.findSub=function(){Reddit.after=[],Reddit.subreddit=$scope.subreddit,$scope.disablePreviousButton(),$scope.getPage()},$scope.parseData=function(data){Reddit.after.push(data.data.after);var posts=data.data.children;angular.forEach(posts,function(post){$scope.getPostType(post)}),$scope.posts=posts},$scope.getPostType=function(post){var url=post.data.url,extension=url.split(".")[url.split(".").length-1],type="";/jpg|png|gif|bmp/.test(extension)?type="image":/imgur.com\/a/.test(url)?type="imguralb":/imgur.com/.test(url)?type="imgur":post.data.selftext?type="text":/youtube.com/.test(url)||/youtu.be/.test(url)||/vimeo/.test(url)?(type="video",post.data.url=$sce.trustAsResourceUrl($scope.makeEmbedable(post.data.url))):type="oembed",post.data.type=type},$scope.makeEmbedable=function(url){return/youtube.com/.test(url)?"http://www.youtube.com/embed/"+url.split("v=")[1]:/youtu.be/.test(url)?"http://www.youtube.com/embed/"+url.split("/")[url.split("/").length-1]:/vimeo.com/.test(url)?"http://player.vimeo.com/video/"+url.split("/")[url.split("/").length-1]:void 0},$scope.nextPage=function(){$scope.getPage(),$("#previous").removeClass("disabled")},$scope.previousPage=function(){Reddit.after.pop(),Reddit.after.pop(),0==Reddit.after.length&&$scope.disablePreviousButton(),$scope.getPage()},$scope.disablePreviousButton=function(){$("#previous").addClass("disabled")},$scope.loadComments=function(permalink){$scope.$broadcast("loadComments",permalink)}}function Comments($scope,$http){$scope.meta=[],$scope.comments=[],$scope.$on("loadComments",function(e,permalink){var winH=$(window).height(),navH=$("#nav").height(),commentsUrl="http://www.reddit.com"+permalink+".json?&sort=best";$("#comments").css("height",winH-navH).addClass("showing"),$http.get(commentsUrl).success(function(data){$scope.parseComments(data),$(".loader").remove()}).error(function(data){console.log(data)})}),$scope.parseComments=function(data){var comments=data[1].data.children;$scope.meta=data[0].data.children[0].data,$scope.comments=comments,console.log($scope.comments)},$scope.closeComments=function(){$("#comments").removeClass("showing")}}+function($){"use strict";function transitionEnd(){var el=document.createElement("bootstrap"),transEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var name in transEndEventNames)if(void 0!==el.style[name])return{end:transEndEventNames[name]}}$.fn.emulateTransitionEnd=function(duration){var called=!1,$el=this;$(this).one($.support.transition.end,function(){called=!0});var callback=function(){called||$($el).trigger($.support.transition.end)};return setTimeout(callback,duration),this},$(function(){$.support.transition=transitionEnd()})}(window.jQuery),+function($){"use strict";var Collapse=function(element,options){this.$element=$(element),this.options=$.extend({},Collapse.DEFAULTS,options),this.transitioning=null,this.options.parent&&(this.$parent=$(this.options.parent)),this.options.toggle&&this.toggle()};Collapse.DEFAULTS={toggle:!0},Collapse.prototype.dimension=function(){var hasWidth=this.$element.hasClass("width");return hasWidth?"width":"height"},Collapse.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var startEvent=$.Event("show.bs.collapse");if(this.$element.trigger(startEvent),!startEvent.isDefaultPrevented()){var actives=this.$parent&&this.$parent.find("> .panel > .in");if(actives&&actives.length){var hasData=actives.data("bs.collapse");if(hasData&&hasData.transitioning)return;actives.collapse("hide"),hasData||actives.data("bs.collapse",null)}var dimension=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[dimension](0),this.transitioning=1;var complete=function(){this.$element.removeClass("collapsing").addClass("in")[dimension]("auto"),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!$.support.transition)return complete.call(this);var scrollSize=$.camelCase(["scroll",dimension].join("-"));this.$element.one($.support.transition.end,$.proxy(complete,this)).emulateTransitionEnd(350)[dimension](this.$element[0][scrollSize])}}},Collapse.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var startEvent=$.Event("hide.bs.collapse");if(this.$element.trigger(startEvent),!startEvent.isDefaultPrevented()){var dimension=this.dimension();this.$element[dimension](this.$element[dimension]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var complete=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")};return $.support.transition?(this.$element[dimension](0).one($.support.transition.end,$.proxy(complete,this)).emulateTransitionEnd(350),void 0):complete.call(this)}}},Collapse.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var old=$.fn.collapse;$.fn.collapse=function(option){return this.each(function(){var $this=$(this),data=$this.data("bs.collapse"),options=$.extend({},Collapse.DEFAULTS,$this.data(),"object"==typeof option&&option);data||$this.data("bs.collapse",data=new Collapse(this,options)),"string"==typeof option&&data[option]()})},$.fn.collapse.Constructor=Collapse,$.fn.collapse.noConflict=function(){return $.fn.collapse=old,this},$(document).on("click.bs.collapse.data-api","[data-toggle=collapse]",function(e){var href,$this=$(this),target=$this.attr("data-target")||e.preventDefault()||(href=$this.attr("href"))&&href.replace(/.*(?=#[^\s]+$)/,""),$target=$(target),data=$target.data("bs.collapse"),option=data?"toggle":$this.data(),parent=$this.attr("data-parent"),$parent=parent&&$(parent);data&&data.transitioning||($parent&&$parent.find('[data-toggle=collapse][data-parent="'+parent+'"]').not($this).addClass("collapsed"),$this[$target.hasClass("in")?"addClass":"removeClass"]("collapsed")),$target.collapse(option)})}(window.jQuery),+function($){"use strict";function clearMenus(){$(backdrop).remove(),$(toggle).each(function(e){var $parent=getParent($(this));$parent.hasClass("open")&&($parent.trigger(e=$.Event("hide.bs.dropdown")),e.isDefaultPrevented()||$parent.removeClass("open").trigger("hidden.bs.dropdown"))})}function getParent($this){var selector=$this.attr("data-target");selector||(selector=$this.attr("href"),selector=selector&&/#/.test(selector)&&selector.replace(/.*(?=#[^\s]*$)/,""));var $parent=selector&&$(selector);return $parent&&$parent.length?$parent:$this.parent()}var backdrop=".dropdown-backdrop",toggle="[data-toggle=dropdown]",Dropdown=function(element){$(element).on("click.bs.dropdown",this.toggle)};Dropdown.prototype.toggle=function(e){var $this=$(this);if(!$this.is(".disabled, :disabled")){var $parent=getParent($this),isActive=$parent.hasClass("open");if(clearMenus(),!isActive){if("ontouchstart"in document.documentElement&&!$parent.closest(".navbar-nav").length&&$('<div class="dropdown-backdrop"/>').insertAfter($(this)).on("click",clearMenus),$parent.trigger(e=$.Event("show.bs.dropdown")),e.isDefaultPrevented())return;$parent.toggleClass("open").trigger("shown.bs.dropdown"),$this.focus()}return!1}},Dropdown.prototype.keydown=function(e){if(/(38|40|27)/.test(e.keyCode)){var $this=$(this);if(e.preventDefault(),e.stopPropagation(),!$this.is(".disabled, :disabled")){var $parent=getParent($this),isActive=$parent.hasClass("open");if(!isActive||isActive&&27==e.keyCode)return 27==e.which&&$parent.find(toggle).focus(),$this.click();var $items=$("[role=menu] li:not(.divider):visible a",$parent);if($items.length){var index=$items.index($items.filter(":focus"));38==e.keyCode&&index>0&&index--,40==e.keyCode&&index<$items.length-1&&index++,~index||(index=0),$items.eq(index).focus()}}}};var old=$.fn.dropdown;$.fn.dropdown=function(option){return this.each(function(){var $this=$(this),data=$this.data("dropdown");data||$this.data("dropdown",data=new Dropdown(this)),"string"==typeof option&&data[option].call($this)})},$.fn.dropdown.Constructor=Dropdown,$.fn.dropdown.noConflict=function(){return $.fn.dropdown=old,this},$(document).on("click.bs.dropdown.data-api",clearMenus).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",toggle,Dropdown.prototype.toggle).on("keydown.bs.dropdown.data-api",toggle+", [role=menu]",Dropdown.prototype.keydown)}(window.jQuery),function(factory){"function"==typeof define&&define.amd?define(["jquery"],factory):factory(jQuery)}(function($){function refresh(){var data=prepareData(this),$s=$t.settings;return isNaN(data.datetime)||(0==$s.cutoff||distance(data.datetime)<$s.cutoff)&&$(this).text(inWords(data.datetime)),this}function prepareData(element){if(element=$(element),!element.data("timeago")){element.data("timeago",{datetime:$t.datetime(element)});var text=$.trim(element.text());$t.settings.localeTitle?element.attr("title",element.data("timeago").datetime.toLocaleString()):!(text.length>0)||$t.isTime(element)&&element.attr("title")||element.attr("title",text)}return element.data("timeago")}function inWords(date){return $t.inWords(distance(date))}function distance(date){return(new Date).getTime()-date.getTime()}$.timeago=function(timestamp){return timestamp instanceof Date?inWords(timestamp):"string"==typeof timestamp?inWords($.timeago.parse(timestamp)):"number"==typeof timestamp?inWords(new Date(timestamp)):inWords($.timeago.datetime(timestamp))};var $t=$.timeago;$.extend($.timeago,{settings:{refreshMillis:6e4,allowFuture:!1,localeTitle:!1,cutoff:0,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:"less than a minute",minute:"a minute",minutes:"%d minutes",hour:"an hour",hours:"%d hours",day:"a day",days:"%d days",month:"a month",months:"%d months",year:"a year",years:"%d years",wordSeparator:" ",numbers:[]}},inWords:function(distanceMillis){function substitute(stringOrFunction,number){var string=$.isFunction(stringOrFunction)?stringOrFunction(number,distanceMillis):stringOrFunction,value=$l.numbers&&$l.numbers[number]||number;return string.replace(/%d/i,value)}var $l=this.settings.strings,prefix=$l.prefixAgo,suffix=$l.suffixAgo;this.settings.allowFuture&&0>distanceMillis&&(prefix=$l.prefixFromNow,suffix=$l.suffixFromNow);var seconds=Math.abs(distanceMillis)/1e3,minutes=seconds/60,hours=minutes/60,days=hours/24,years=days/365,words=45>seconds&&substitute($l.seconds,Math.round(seconds))||90>seconds&&substitute($l.minute,1)||45>minutes&&substitute($l.minutes,Math.round(minutes))||90>minutes&&substitute($l.hour,1)||24>hours&&substitute($l.hours,Math.round(hours))||42>hours&&substitute($l.day,1)||30>days&&substitute($l.days,Math.round(days))||45>days&&substitute($l.month,1)||365>days&&substitute($l.months,Math.round(days/30))||1.5>years&&substitute($l.year,1)||substitute($l.years,Math.round(years)),separator=$l.wordSeparator||"";return void 0===$l.wordSeparator&&(separator=" "),$.trim([prefix,words,suffix].join(separator))},parse:function(iso8601){var s=$.trim(iso8601);return s=s.replace(/\.\d+/,""),s=s.replace(/-/,"/").replace(/-/,"/"),s=s.replace(/T/," ").replace(/Z/," UTC"),s=s.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2"),new Date(s)},datetime:function(elem){var iso8601=$t.isTime(elem)?$(elem).attr("datetime"):$(elem).attr("title");return $t.parse(iso8601)},isTime:function(elem){return"time"===$(elem).get(0).tagName.toLowerCase()}});var functions={init:function(){var refresh_el=$.proxy(refresh,this);refresh_el();var $s=$t.settings;$s.refreshMillis>0&&setInterval(refresh_el,$s.refreshMillis)},update:function(time){$(this).data("timeago",{datetime:$t.parse(time)}),refresh.apply(this)},updateFromDOM:function(){$(this).data("timeago",{datetime:$t.parse($t.isTime(this)?$(this).attr("datetime"):$(this).attr("title"))}),refresh.apply(this)}};$.fn.timeago=function(action,options){var fn=action?functions[action]:functions.init;if(!fn)throw new Error("Unknown function name '"+action+"' for timeago");return this.each(function(){fn.call(this,options)}),this},document.createElement("abbr"),document.createElement("time")});var Settings={numPosts:25,sortBy:"new"},Reddit={after:[],subreddit:""};angular.module("app",["ngRoute","filters"]),angular.module("filters",[]).filter("timeago",function(){return function(timestamp){return jQuery.timeago(new Date(1e3*timestamp))}});